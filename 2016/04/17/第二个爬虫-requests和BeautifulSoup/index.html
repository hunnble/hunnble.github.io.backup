<!DOCTYPE html>
<html lang="zh-Hans">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="90åï¼Œå¼‚æ€§æ‹ï¼Œé£å¤©æ‹‰é¢æ•™ï¼Œæ¢¦æƒ³æ˜¯å˜èƒ–ã€‚æœ€æƒ³æˆä¸ºçš„äººæ˜¯æŒªå¨çš„æ£®æ—é‡Œçš„æ¸¡è¾¹ï¼Œå…¶æ¬¡æƒ³æˆä¸ºå—æ–¹å…¬å›­é‡Œçš„Eric Cartmanã€‚">
    

    <!--Author-->
    
        <meta name="author" content="Noski">
    

    <!-- Title -->
    
    <title>ç¬¬äºŒä¸ªçˆ¬è™«:requestså’ŒBeautifulSoup | åŒ—æ–¹å…¬å›­</title>

    <!-- Bootstrap Core CSS -->
    <link href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

    <!-- Content -->
    <section class="article-container">
<!-- Back Home -->
<a class="nav-back" href="/">
    <i class="fa fa-puzzle-piece"></i>
</a>

<!-- Page Header -->
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>ç¬¬äºŒä¸ªçˆ¬è™«:requestså’ŒBeautifulSoup</h1>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="post-content col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>ä»Šå¤©åˆå­¦ä¹ å†™äº†ä¸€ä¸ªçˆ¬è™«,çˆ¬å–è±†ç“£å‰250ä¸ªç”µå½±çš„åç§°ã€‚ä½¿ç”¨äº†requestså’ŒBeautifulSoupè¿™ä¸¤ä¸ªç¬¬ä¸‰æ–¹åº“æ¥è¾…åŠ©æˆ‘ã€‚<br><a href="http://docs.python-requests.org/en/latest/" target="_blank" rel="external">requestså®˜ç½‘</a><br><a href="https://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="external">BeautifulSoupå®˜ç½‘</a><br>ä½¿ç”¨pipå®‰è£…ç¬¬ä¸‰æ–¹åº“ä¹‹åå°±å¯ä»¥å¼€å§‹ç¼–å†™çˆ¬è™«äº†ã€‚<br><a id="more"></a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> codecs</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"></div><div class="line">DOWNLOAD_URL = <span class="string">'http://movie.douban.com/top250'</span></div><div class="line">HEADERS = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.80 Safari/537.36'</span>&#125;</div></pre></td></tr></table></figure></p>
<p>codecså¤„ç†å­—ç¬¦,urlå°±æ˜¯è¦å¼€å§‹çˆ¬çš„é¡µé¢,httpå¤´ä¼ªè£…æˆæµè§ˆå™¨ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_page</span><span class="params">(url)</span>:</span></div><div class="line">    data = requests.get(url, headers=HEADERS).content</div><div class="line">    <span class="keyword">return</span> data</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨requestså¯ä»¥ä¸éœ€è¦manual laboræ¥è¿›è¡Œgetæˆ–è€…postè¯·æ±‚,èŠ‚çœäº†æˆ‘ä¸å°‘åŠŸå¤«ã€‚è¿™ä¸ªå‡½æ•°å¾ˆç®€å•,å°±æ˜¯ç›´æ¥getåˆ°ç›®æ ‡urlçš„é¡µé¢å†…å®¹å¹¶è¿”å›<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_html</span><span class="params">(html)</span>:</span></div><div class="line">    soup = BeautifulSoup(html)</div><div class="line">    movie_list_soup = soup.find(<span class="string">'ol'</span>, attrs=&#123;<span class="string">'class'</span>: <span class="string">'grid_view'</span>&#125;)</div><div class="line">    movie_name_list = []</div><div class="line">    <span class="keyword">for</span> movie_li <span class="keyword">in</span> movie_list_soup.find_all(<span class="string">'li'</span>):</div><div class="line">        detail = movie_li.find(<span class="string">'div'</span>, attrs=&#123;<span class="string">'class'</span>: <span class="string">'hd'</span>&#125;)</div><div class="line">        movie_name = detail.find(<span class="string">'span'</span>, attrs=&#123;<span class="string">'class'</span>: <span class="string">'title'</span>&#125;).getText()</div><div class="line">        movie_name_list.append(movie_name)</div><div class="line">    next_page = soup.find(<span class="string">'span'</span>, attrs=&#123;<span class="string">'class'</span>: <span class="string">'next'</span>&#125;).find(<span class="string">'a'</span>)</div><div class="line">    <span class="keyword">if</span> next_page:</div><div class="line">        <span class="keyword">return</span> movie_name_list, DOWNLOAD_URL + next_page[<span class="string">'href'</span>]</div><div class="line">    <span class="keyword">return</span> movie_name_list, <span class="keyword">None</span></div></pre></td></tr></table></figure></p>
<p>è¿™ä¸ªå‡½æ•°å°±æ˜¯è§£æhtmlé¡µé¢äº†ã€‚ä½¿ç”¨å¼€å‘è€…å·¥å…·åˆ†æé¡µé¢å‘ç°ç”µå½±åˆ†åœ¨10é¡µé‡Œ,æ¯ä¸ªç”µå½±çš„ä¿¡æ¯éƒ½åœ¨ol(class=â€grid_viewâ€)çš„åˆ—è¡¨çš„liä¸­ã€‚ç”µå½±ååœ¨liä¸­çš„div(class=â€hdâ€)ä¸­ã€‚æ‰€ä»¥ä½¿ç”¨BeautifulSoupçš„find_allå’Œfindå‡½æ•°æ¥æ‰¾ã€‚<br>ç„¶åå°±æ˜¯å¯»æ‰¾æœ‰æ²¡æœ‰ä¸‹ä¸€é¡µè¿™ä¸ªaæ ‡ç­¾,åˆ†æé¡µé¢å‘ç°å®ƒæ˜¯åœ¨span(class=â€nextâ€)ä¸­çš„,å¦‚æœæœ‰å°±è¿”å›å·²ç»çˆ¬åˆ°çš„æ‰€æœ‰çš„ç”µå½±åæ•°ç»„å’Œä¸‹ä¸€é¡µçš„é“¾æ¥,å¦åˆ™è¿”å›ç”µå½±åæ•°ç»„å’ŒNone,ä»£è¡¨çˆ¬å®Œäº†ã€‚<br>ä¸‹é¢å°±æ˜¯å‘æ–‡ä»¶ä¸­è¾“å‡ºå’Œè°ƒç”¨äº†:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">url = DOWNLOAD_URL</div><div class="line"><span class="keyword">with</span> codecs.open(<span class="string">'movie.out'</span>, <span class="string">'wb'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</div><div class="line">    <span class="keyword">while</span>(url):</div><div class="line">        html = download_page(url)</div><div class="line">        movies, url = parse_html(html)</div><div class="line">        fp.write(<span class="string">u'&#123;movies&#125;\n'</span>.format(movies=<span class="string">'\n'</span>.join(movies)))</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">main()</div></pre></td></tr></table></figure></p>
<p>ç”¨æ¢è¡Œç¬¦åˆ†éš”,æ¯ä¸ªåå­—ä¸€è¡Œã€‚è¿è¡Œä¹‹åæ‰“å¼€movie.out(è¿™ä¸ªæ–‡ä»¶è·¯å¾„å¯ä»¥éšæ„æŒ‡å®š)å‘ç°250ä¸ªç”µå½±çš„åå­—å·²ç»çˆ¬ä¸‹æ¥äº†ã€‚</p>
<p>pythonçš„ç¬¬ä¸‰æ–¹åº“æœç„¶å¾ˆä¸°å¯Œå¾ˆå¼ºå¤§ã€‚</p>

 
                <!-- Meta -->
                <div class="post-meta">
                    <hr>
                    <br>
                    <div class="post-tags">
                        
                            

<a href="/tag/python/">#python</a>


                        
                    </div>
                    <div class="post-date">
                        2016 å¹´ 04 æœˆ 17 æ—¥
                    </div>
                </div>
            </div>

            <!-- Comments -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- Disqus Comments -->


            </div>
        </div>
    </div>
</article>
</section>

    <!-- Scripts -->
    <!-- jQuery -->
<script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="//cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script type="text/javascript">
	console.log('Hexo-theme-hollow designed by zchen9 ğŸ™‹ Â© 2015-' + (new Date()).getFullYear());
</script>

    <!-- Google Analytics -->
    

</body>

</html>